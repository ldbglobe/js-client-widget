{"version":3,"file":"Client.js","mappings":"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","sources":["webpack:///webpack/bootstrap","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///../node_modules/js-class.event-dispatcher/src/index.js","webpack:///../node_modules/js-class.messenger/src/index.js","webpack:///../src/components/ClientComponent.js","webpack:///../src/components/WidgetComponent.js","webpack:///./src/Client.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export default class EventDispatcher {\r\n\tconstructor(eventSource) {\r\n\t\tthis.eventSource = eventSource;\r\n\t\tthis.events = new Set();\r\n\t}\r\n\r\n\t// registration methods\r\n\tregisterEvent(eventName, callback) {\r\n\t\tif(typeof callback === \"function\")\r\n\t\t{\r\n\t\t\tif(!this.events[eventName])\r\n\t\t\t\tthis.events[eventName] = new Set();\r\n\r\n\t\t\tthis.events[eventName].add(callback)\r\n\t\t}\r\n\t}\r\n\tunregisterEvent(eventName, callback) {\r\n\t\tif(this.events[eventName])\r\n\t\t\tthis.events[eventName].delete(callback)\r\n\t}\r\n\r\n\t// trigger event\r\n\tfireEvent(eventName, data) {\r\n\t\tif(this.events[eventName])\r\n\t\t{\r\n\t\t\tthis.events[eventName].forEach(function(callback, index) {\r\n\t\t\t\tcallback(data,{\r\n\t\t\t\t\teventSource:this.eventSource,\r\n\t\t\t\t\teventName:eventName,\r\n\t\t\t\t\tdata:data\r\n\t\t\t\t});\r\n\t\t\t}.bind(this))\r\n\t\t}\r\n\t}\r\n}","import EventDispatcher from \"js-class.event-dispatcher\";\r\n\r\nwindow.MessengerWelcome_260b9b39071b9918 = function(w=null)\r\n{\r\n\tif(w)\r\n\t\tMessenger.___.recipients.add(w)\r\n\telse\r\n\t{\r\n\t\tif(window.opener && typeof window.opener.MessengerWelcome_260b9b39071b9918 === \"function\")\r\n\t\t\twindow.opener.MessengerWelcome_260b9b39071b9918(window);\r\n\t}\r\n}\r\n\r\nexport default class Messenger {\r\n\r\n\tstatic ___ = {\r\n\t\trecipients: new Set(),\r\n\t}\r\n\r\n\tconstructor(param) {\r\n\t\tparam = typeof param ===\"string\" ? {channel:param}: param || {};\r\n\t\tthis.id = (()=>('MSG_'+[1e16]).replace(/[018]/g,a=>(a^Math.random()*16>>a/4).toString(16)))();\r\n\t\tthis.channels = new Set();\r\n\t\tthis.recipients = new Set();\r\n\r\n\t\tif(param.channel)\r\n\t\t\tthis.subscribe(param.channel);\r\n\r\n\t\tif(window.opener)\r\n\t\t\tMessenger.___.recipients.add(window.opener);\r\n\r\n\t\tthis.events = new EventDispatcher(this);\r\n\t\twindow.addEventListener('message', this.__handleMessage.bind(this))\r\n\r\n\t\twindow.MessengerWelcome_260b9b39071b9918();\r\n\t}\r\n\r\n\tsubscribe(channel) {\r\n\t\tif(channel && typeof channel === \"string\")\r\n\t\t{\r\n\t\t\tconsole.info(`Messenger ${this.id} connected to ${channel}`);\r\n\t\t\tthis.channels.add(channel)\r\n\t\t}\r\n\t}\r\n\tunsubscribe(channel) {\r\n\t\tthis.channels.delete(channel)\r\n\t}\r\n\r\n\tonMessage(callback,channels=null) {\r\n\t\tchannels = typeof channels === \"string\" ? [channels] : channels;\r\n\t\tchannels = channels && channels.length ? channels : [];\r\n\t\tthis.events.registerEvent('message',function(callback, channels, data, eventSource) {\r\n\t\t\tif(channels.length===0 || channels.includes(data.channel))\r\n\t\t\t\tcallback(data.message,data.channel)\r\n\t\t}.bind(this, callback, channels))\r\n\t}\r\n\r\n\t__handleMessage(e) {\r\n\t\tlet data = typeof e.data === \"string\" ? JSON.parse(e.data) : (e.data || {});\r\n\t\tif(data.format === 'messenger')\r\n\t\t{\r\n\t\t\t// relay all channel on other windows\r\n\t\t\tthis.send(data.message,data.channel,e.source,true)\r\n\r\n\t\t\t// fire local event if channel is subscribed\r\n\t\t\tif(this.channels.has(data.channel))\r\n\t\t\t{\r\n\t\t\t\tthis.events.fireEvent('message',data);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tsend(message,destinationChannel=null,emiter=null,relay=false) {\r\n\t\tif(destinationChannel && !this.channels.has(destinationChannel))\r\n\t\t{\r\n\t\t\tif(!relay)\r\n\t\t\t\tthrow `Messenger.send not subscribed to ${destinationChannel}`\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tvar channels = destinationChannel ? new Set([destinationChannel]) : this.channels;\r\n\t\t\tif(channels.size>0)\r\n\t\t\t{\r\n\t\t\t\tchannels.forEach(function(message,destinationChannel,emiter,channel) {\r\n\t\t\t\t\tif(destinationChannel===null || destinationChannel === channel)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tthis.__sendToWindows(JSON.stringify({\r\n\t\t\t\t\t\t\tformat:'messenger',\r\n\t\t\t\t\t\t\tversion:1,\r\n\t\t\t\t\t\t\temiter:this.id,\r\n\t\t\t\t\t\t\tchannel:channel,\r\n\t\t\t\t\t\t\tmessage:message,\r\n\t\t\t\t\t\t}),emiter);\r\n\t\t\t\t\t}\r\n\t\t\t\t}.bind(this,message,destinationChannel,emiter));\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\t// No destination channels available, Nothing to do ^^\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t__sendToWindows(payload,emiter) {\r\n\t\tMessenger.___.recipients.forEach(function(emiter,recipient){\r\n\t\t\tif(recipient && typeof recipient.postMessage === \"function\")\r\n\t\t\t{\r\n\t\t\t\tif(emiter!==recipient && !recipient.closed)\r\n\t\t\t\t\trecipient.postMessage(payload,\"*\");\r\n\t\t\t}\r\n\t\t}.bind(this,emiter))\r\n\t}\r\n}","import EventDispatcher from \"js-class.event-dispatcher\";\r\nimport Messenger from \"js-class.messenger\";\r\n\r\nexport default class ClientComponent {\r\n\tstatic ___ = {\r\n\t\topened:new Set(),\r\n\t\tinstances:new Set(),\r\n\t};\r\n\tconstructor(param) {\r\n\t\tparam = param || {};\r\n\t\tparam.widget = param.widget || {};\r\n\r\n\t\tthis.___ = {\r\n\t\t\tid: (()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,a=>(a^Math.random()*16>>a/4).toString(16)))(),\r\n\t\t\twidget: {\r\n\t\t\t\tlimit:      param.widget.limit      || param.widgetLimit      || 1,\r\n\t\t\t\turl:        param.widget.url        || param.widgetUrl        || null,\r\n\t\t\t\tresizable:  param.widget.resizable  || param.widgetResizable  || true,\r\n\t\t\t\tscrollbars: param.widget.scrollbars || param.widgetScrollbars || true,\r\n\t\t\t\tdependent:  param.widget.dependent  || param.widgetDependent  || true,\r\n\t\t\t\twidth:      param.widget.width      || param.widgetWidth      || 600,\r\n\t\t\t\theight:     param.widget.height     || param.widgetHeight     || 400,\r\n\t\t\t\ttop:        param.widget.top        || param.widgetTop        || null,\r\n\t\t\t\tleft:       param.widget.left       || param.widgetLeft       || null,\r\n\t\t\t\twindow:     null,\r\n\t\t\t},\r\n\t\t\tdefaults:undefined, // defaults data (can be set up on widget open)\r\n\t\t\tkeepDefaults:false, // if set to true, keep defaults data accross widget open/close cycles\r\n\t\t\tcloseDetectionInterval: null,\r\n\t\t};\r\n\r\n\t\tthis.___.events = new EventDispatcher(this);\r\n\t\tthis.___.messenger = new Messenger({channel:this.___.id});\r\n\t\tthis.___.messenger.onMessage(this.___handleMessage.bind(this));\r\n\r\n\t\tClientComponent.___.instances.add(this);\r\n\r\n\t\t// handle native defaults data exchange\r\n\t\tthis.___on('widget.ready',this.___postDefaults.bind(this)); // automatic on widget is ready\r\n\r\n\t\t// autoclose widget on client page refresh or close\r\n\t\twindow.addEventListener(\"beforeunload\",this.close.bind(this),true);\r\n\t}\r\n\r\n\t// call a method or apply a calback on all client instances registered\r\n\tstatic invokeAll(methodOrCallback,args) {\r\n\t\tif(typeof methodOrCallback === \"function\")\r\n\t\t{\r\n\t\t\tClientComponent.___.instances.forEach(function(client) { methodOrCallback(client) });\r\n\t\t}\r\n\t\telse if(typeof methodOrCallback === \"string\")\r\n\t\t{\r\n\t\t\tClientComponent.___.instances.forEach(function(client) {\r\n\t\t\t\treturn typeof client?.[methodOrCallback] === \"function\" ? client?.[methodOrCallback](...args) : null;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t___getId() { return this.___.id; }\r\n\tgetId() { return this.___getId(); }\r\n\r\n\t/* --------------------------------------------------\r\n\t * Native available events\r\n\t * --------------------------------------------------\r\n\t * widget.open\r\n\t * widget.ready\r\n\t * widget.close\r\n\t*/\r\n\t___on(eventName,callback) { this.___.events.registerEvent(eventName,callback) }\r\n\ton(eventName,callback) { this.___on(eventName,callback); }\r\n\r\n\t___off(eventName,callback) { this.___.events.unregisterEvent(eventName,callback) }\r\n\toff(eventName,callback) { this.___off(eventName,callback); }\r\n\r\n\t// all the events are handled by the messenger services\r\n\t___fire(eventName,data,dest=null) {\r\n\t\t// send event to the widget\r\n\t\tif(dest === null || dest === \"broadcast\")\r\n\t\t{\r\n\t\t\tthis.___.messenger.send({eventName, data});\r\n\t\t}\r\n\t\t// fire the event locally\r\n\t\tif(dest === null || dest === \"local\")\r\n\t\t{\r\n\t\t\tthis.___.events.fireEvent(eventName, data);\r\n\t\t}\r\n\t}\r\n\tfire(eventName,data,dest=null) { this.___fire(eventName,data,dest); }\r\n\r\n\t___open(widgetOptions=null,defaults=undefined) {\r\n\t\t// close current instance (if previously opened)\r\n\t\tthis.close();\r\n\t\t// close any extra instances  previously opened\r\n\t\tthis.___openedLimitRelease();\r\n\t\t// open new window and register the client as opened\r\n\r\n\t\twidgetOptions = widgetOptions || {};\r\n\t\twidgetOptions.url        = widgetOptions.url        || this.___.widget.url;\r\n\t\twidgetOptions.resizable  = widgetOptions.resizable  || this.___.widget.resizable;\r\n\t\twidgetOptions.scrollbars = widgetOptions.scrollbars || this.___.widget.scrollbars;\r\n\t\twidgetOptions.dependent  = widgetOptions.dependent  || this.___.widget.dependent;\r\n\t\twidgetOptions.width      = widgetOptions.width      || this.___.widget.width;\r\n\t\twidgetOptions.height     = widgetOptions.height     || this.___.widget.height;\r\n\t\twidgetOptions.top        = widgetOptions.top        || this.___.widget.top;\r\n\t\twidgetOptions.left       = widgetOptions.left       || this.___.widget.left;\r\n\r\n\t\t// position set at screen center if top or left no set\r\n\t\twidgetOptions.top = widgetOptions.top || (screen.height - widgetOptions.height) / 2;\r\n\t\twidgetOptions.left = widgetOptions.left || (screen.width - widgetOptions.width) / 2;\r\n\r\n\t\tvar windowSettings = [];\r\n\t\twindowSettings.push(`resizable=${widgetOptions.resizable ? 'yes':'no'}`);\r\n\t\twindowSettings.push(`scrollbars=${widgetOptions.scrollbars ? 'yes':'no'}`);\r\n\t\twindowSettings.push(`dependent=${widgetOptions.dependent ? 'yes':'no'}`);\r\n\t\tif(widgetOptions.width)  windowSettings.push(`width=${widgetOptions.width}`);\r\n\t\tif(widgetOptions.height) windowSettings.push(`height=${widgetOptions.height}`);\r\n\t\tif(widgetOptions.top)    windowSettings.push(`top=${widgetOptions.top}`);\r\n\t\tif(widgetOptions.left)   windowSettings.push(`left=${widgetOptions.left}`);\r\n\r\n\t\tvar widgetUrl = widgetOptions.url;\r\n\r\n\t\tif(!widgetUrl)\r\n\t\t{\r\n\t\t\tthrow `widget url parameter missing`;\r\n\t\t\treturn ;\r\n\t\t}\r\n\r\n\t\tif(defaults!==undefined)\r\n\t\t\tthis.___.defaults = defaults;\r\n\r\n\t\tthis.___.widget.window = window.open(widgetUrl, this.___.id, windowSettings.join(','));\r\n\r\n\t\tClientComponent.___.opened.add(this);\r\n\t\t// then set messenger link, send event and start the \"close\" watcher\r\n\t\tthis.___fire('widget.open',null,\"local\");\r\n\t\tthis.___startDetectionLoop();\r\n\t}\r\n\topen(widgetOptions,defaults=null) { this.___open(widgetOptions,defaults); }\r\n\r\n\t___close() {\r\n\t\tthis.___stopDetectionLoop();\r\n\t\tClientComponent.___.opened.delete(this);\r\n\t\tif(this.___.widget.window && !this.___.widget.window.closed)\r\n\t\t{\r\n\t\t\tthis.___.widget.window.close();\r\n\t\t\tthis.___.widget.window = null;\r\n\t\t\tif(!this.___.keepDefaults)\r\n\t\t\t\tthis.___.defaults = undefined;\r\n\t\t\tthis.___fire('widget.close',null,\"local\");\r\n\t\t}\r\n\t}\r\n\tclose() { this.___close(); }\r\n\r\n\t// **********************************************************\r\n\t// private methods\r\n\t// **********************************************************\r\n\r\n\t// close older client->widget to set a new free slot\r\n\t___openedLimitRelease() {\r\n\t\tvar deleteCount = ClientComponent.___.opened.size - this.___.widget.limit + 1;\r\n\t\tvar list = Array.from(ClientComponent.___.opened).reverse();\r\n\t\tfor (let c of list) {\r\n\t\t\tif(deleteCount>0)\r\n\t\t\t{\r\n\t\t\t\tdeleteCount--;\r\n\t\t\t\tc.close();\r\n\t\t\t\tClientComponent.___.opened.delete(c)\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// generic message handling and event dispatch\r\n\t___handleMessage(message) {\r\n\t\tif(message.eventName)\r\n\t\t{\r\n\t\t\t// received event => only local dispatch\r\n\t\t\tthis.___fire(message.eventName, message.data, \"local\");\r\n\t\t}\r\n\t}\r\n\r\n\t___postDefaults() {\r\n\t\tif(this.___.defaults)\r\n\t\t{\r\n\t\t\tthis.___.messenger.send({\r\n\t\t\t\teventName:'client.postDefaults',\r\n\t\t\t\tdata:this.___.defaults\r\n\t\t\t});\r\n\t\t\t// we dont unset the data so each time we reload the data still remain for a new initialization\r\n\t\t}\r\n\t}\r\n\tpostDefaults() {\r\n\t\tthis.___postDefaults()\r\n\t}\r\n\r\n\t___setDefaults(defaults) {\r\n\t\tthis.___.defaults = defaults;\r\n\t\tthis.___postDefaults(); // send the new defaults\r\n\t}\r\n\tsetDefaults(defaults) {\r\n\t\tthis.___setDefaults(defaults)\r\n\t}\r\n\t___keepDefaults(keep) {\r\n\t\tthis.___.keepDefaults = keep;\r\n\t}\r\n\tkeepDefaults(keep) {\r\n\t\tthis.___keepDefaults(keep)\r\n\t}\r\n\r\n\t// passive detection of widget popup close event\r\n\t// we do not need messenging for this\r\n\t___stopDetectionLoop() {\r\n\t\tclearInterval(this.___.closeDetectionInterval);\r\n\t\tthis.___.closeDetectionInterval = null;\r\n\t}\r\n\t___startDetectionLoop() {\r\n\t\tif(this.___.widget.window.closed)\r\n\t\t{\r\n\t\t\tthis.___close();\r\n\t\t\tthis.___fire('widget.close',null,\"local\");\r\n\t\t}\r\n\t\telse if(!this.___.closeDetectionInterval)\r\n\t\t{\r\n\t\t\tthis.___.closeDetectionInterval = setInterval(this.___startDetectionLoop.bind(this),10);\r\n\t\t}\r\n\t}\r\n}","import EventDispatcher from \"js-class.event-dispatcher\";\r\nimport Messenger from \"js-class.messenger\";\r\n\r\nexport default  class WidgetComponent {\r\n\tstatic ___ = { };\r\n\r\n\tconstructor(param) {\r\n\t\tparam = param || {};\r\n\r\n\t\tthis.___ = {\r\n\t\t\tid: param.id || window.name, // as default behavior, JS client set the ID in the windows name\r\n\t\t\tdefaults:undefined,\r\n\t\t\tdefaultsVersion:0,\r\n\t\t};\r\n\r\n\t\tconsole.log(this.___.id)\r\n\r\n\t\tthis.___.events = new EventDispatcher(this);\r\n\t\tthis.___.messenger = new Messenger({channel:this.___.id});\r\n\t\tthis.___.messenger.onMessage(this.___handleMessage.bind(this));\r\n\r\n\t\t// send a ready message to the opener\r\n\t\tsetTimeout(function(){ this.___fire('widget.ready',null,\"broadcast\"); }.bind(this),0);\r\n\r\n\t\tthis.___on('client.postDefaults',this.___handleDefaults.bind(this));\r\n\t}\r\n\r\n\t___getId() { return this.___.id; }\r\n\tgetId() { return this.___getId(); }\r\n\r\n\t/* --------------------------------------------------\r\n\t * Native available events\r\n\t * --------------------------------------------------\r\n\t * client.postDefaults // avoid to use this one\r\n\t * widget.defaults.init\r\n\t * widget.defaults.update\r\n\t */\r\n\r\n\t___on(eventName,callback) { this.___.events.registerEvent(eventName,callback); }\r\n\ton(eventName,callback) { this.___on(eventName,callback); }\r\n\r\n\t___off(eventName,callback) { this.___.events.unregisterEvent(eventName,callback); }\r\n\toff(eventName,callback) { this.___off(eventName,callback); }\r\n\r\n\t// all the events are handled by the messenger services\r\n\t___fire(eventName,data,dest=null) {\r\n\t\t// send event to the widget\r\n\t\tif(dest === null || dest === \"broadcast\")\r\n\t\t{\r\n\t\t\tthis.___.messenger.send({eventName, data});\r\n\t\t}\r\n\t\t// fire the event locally\r\n\t\tif(dest === null || dest === \"local\")\r\n\t\t{\r\n\t\t\tthis.___.events.fireEvent(eventName, data);\r\n\t\t}\r\n\t}\r\n\tfire(eventName,data,dest=null) { this.___fire(eventName,data,dest); }\r\n\r\n\t___handleMessage(message) {\r\n\t\tif(message.eventName)\r\n\t\t{\r\n\t\t\t// received event => only local dispatch\r\n\t\t\tthis.___fire(message.eventName,message.data,\"local\");\r\n\t\t}\r\n\t}\r\n\r\n\t___handleDefaults(defaults)\t{\r\n\t\tthis.___.defaults = defaults;\r\n\t\tthis.___.defaultsVersion++;\r\n\r\n\t\tif(this.___.defaultsVersion===1)\r\n\t\t\tthis.___fire('widget.defaults.init',this.___.defaults,'local')\r\n\t\telse\r\n\t\t\tthis.___fire('widget.defaults.update',this.___.defaults,'local')\r\n\t}\r\n\t___getDefaults() {\r\n\t\treturn this.___.defaults;\r\n\t}\r\n\tgetDefaults() {\r\n\t\treturn this.___getDefaults();\r\n\t}\r\n\r\n\t___isDefaultsAvailable() {\r\n\t\treturn this.___.defaultsVersion>0\r\n\t}\r\n\tisDefaultsAvailable() {\r\n\t\treturn this.___isDefaultsAvailable();\r\n\t}\r\n}","import { ClientComponent } from \"../../src/index.js\"\r\n\r\nexport class Client extends ClientComponent {\r\n\r\n\t/* --------------------------------------------------\r\n\t * Inherited methods\r\n\t * --------------------------------------------------\r\n\t * open()\r\n\t * close()\r\n\t * getId()\r\n\t * on((string)eventName,(function)callback)\r\n\t * off((string)eventName,(function)callback)\r\n\t * fire((string)eventName,(mixed)data,([null,client,widget])destination)\r\n\t * --------------------------------------------------\r\n\t * Native events name\r\n\t * --------------------------------------------------\r\n\t * widget.open\r\n\t * widget.ready\r\n\t * widget.close\r\n\t * --------------------------------------------------\r\n\t * Additionnal events from the extenbded Widget class\r\n\t * --------------------------------------------------\r\n\t * select\r\n\t*/\r\n\r\n\tconstructor(param) {\r\n\t\tparam = param || {};\r\n\t\tparam.widgetUrl = param.widgetUrl || './widget.html?custom-url=set-in-the-custom-client-class';\r\n\t\tsuper(param);\r\n\r\n\t\tthis.on('TEST-EVENT',() => console.log('TEST-EVENT received in the client'));\r\n\t}\r\n\r\n\tdisplayMessage(message) {\r\n\t\tthis.fire('display-message',message);\r\n\t}\r\n}\r\nwindow.Client = Client;"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","EventDispatcher","constructor","eventSource","this","events","Set","registerEvent","eventName","callback","add","unregisterEvent","delete","fireEvent","data","forEach","index","bind","window","MessengerWelcome_260b9b39071b9918","w","Messenger","___","recipients","opener","static","param","channel","id","replace","a","Math","random","toString","channels","subscribe","addEventListener","__handleMessage","console","info","unsubscribe","onMessage","length","includes","message","e","JSON","parse","format","send","source","has","destinationChannel","emiter","relay","size","__sendToWindows","stringify","version","payload","recipient","postMessage","closed","ClientComponent","widget","limit","widgetLimit","url","widgetUrl","resizable","widgetResizable","scrollbars","widgetScrollbars","dependent","widgetDependent","width","widgetWidth","height","widgetHeight","top","widgetTop","left","widgetLeft","defaults","undefined","keepDefaults","closeDetectionInterval","messenger","___handleMessage","instances","___on","___postDefaults","close","___getId","___off","dest","___fire","widgetOptions","___openedLimitRelease","screen","windowSettings","push","open","join","opened","___startDetectionLoop","___open","___stopDetectionLoop","___close","deleteCount","Array","from","reverse","c","___setDefaults","keep","___keepDefaults","clearInterval","setInterval","methodOrCallback","args","client","WidgetComponent","name","defaultsVersion","log","setTimeout","___handleDefaults","___getDefaults","___isDefaultsAvailable","Client","on","fire"],"sourceRoot":""}