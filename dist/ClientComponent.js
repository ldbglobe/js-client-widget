(()=>{"use strict";var e={r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}};function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}
/*!********************************************!*\
  !*** ./src/ClientComponent.js + 3 modules ***!
  \********************************************/
e.r({});var n=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventSource=t,this.events=new Set}var n,i,r;return n=e,(i=[{key:"registerEvent",value:function(e,t){"function"==typeof t&&(this.events[e]||(this.events[e]=new Set),this.events[e].add(t))}},{key:"unregisterEvent",value:function(e,t){this.events[e]&&this.events[e].delete(t)}},{key:"fireEvent",value:function(e,t){this.events[e]&&this.events[e].forEach(function(n,i){n(t,{eventSource:this.eventSource,eventName:e,data:t})}.bind(this))}}])&&t(n.prototype,i),r&&t(n,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this.setRecipient(t.recipient),this.id=t.id||([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^16*Math.random()>>e/4).toString(16)})),this.events=new n(this),window.addEventListener("message",this.__handleMessage.bind(this))}var t,r,o;return t=e,(r=[{key:"clearRecipient",value:function(){this.recipients=new Set}},{key:"setRecipient",value:function(e){e&&e.length>0?this.recipients=new Set(e):e?this.recipients=new Set([e]):this.clearRecipient()}},{key:"addRecipient",value:function(e){e&&this.recipients.add(e)}},{key:"deleteRecipient",value:function(e){e&&this.recipients.delete(e)}},{key:"getId",value:function(){return this.id}},{key:"on",value:function(e,t){this.events.registerEvent(e,t)}},{key:"off",value:function(e,t){this.events.unregisterEvent(e,t)}},{key:"__handleMessage",value:function(e){var t="string"==typeof e.data?JSON.parse(e.data):e.data||{};"messenger"===t.format&&t.id===this.id&&this.events.fireEvent("message",t.message)}},{key:"send",value:function(e){this.recipients.size>0&&this.recipients.forEach(function(e,t){"function"==typeof t.postMessage&&t.postMessage(JSON.stringify({format:"messenger",version:1,id:this.id,message:e}),"*")}.bind(this,e))}}])&&i(t.prototype,r),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var l,c,u,d=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(t=t||{}).widget=t.widget||{},this.___={id:([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^16*Math.random()>>e/4).toString(16)})),widget:{limit:t.widget.limit||t.widgetLimit||1,url:t.widget.url||t.widgetUrl||null,resizable:t.widget.resizable||t.widgetResizable||!0,scrollbars:t.widget.scrollbars||t.widgetScrollbars||!0,dependent:t.widget.dependent||t.widgetDependent||!0,width:t.widget.width||t.widgetWidth||600,height:t.widget.height||t.widgetHeight||400,top:t.widget.top||t.widgetTop||null,left:t.widget.left||t.widgetLeft||null,window:null},closeDetectionInterval:null},this.___.widget.top=this.___.widget.top||(screen.height-this.___.widget.height)/2,this.___.widget.left=this.___.widget.left||(screen.width-this.___.widget.width)/2,this.___.events=new n(this),this.___.messenger=new r({id:this.___.id}),this.___.messenger.on("message",this.___handleMessage.bind(this)),!this.___.widget.url)throw"widge.url parameter is mandatory";if(this.___.widget.url.match(/#/))throw"widget.url parameter can not contain any hash (".concat(this.___.widget.url,")");e.___.instances.add(this)}var t,i,a;return t=e,i=[{key:"___getId",value:function(){return this.___.id}},{key:"getId",value:function(){return this.___getId()}},{key:"___on",value:function(e,t){this.___.events.registerEvent(e,t)}},{key:"on",value:function(e,t){this.___on(e,t)}},{key:"___off",value:function(e,t){this.___.events.unregisterEvent(e,t)}},{key:"off",value:function(e,t){this.___off(e,t)}},{key:"___fire",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null!==n&&"broadcast"!==n||this.___.messenger.send({eventName:e,data:t}),null!==n&&"local"!==n||this.___.events.fireEvent(e,t)}},{key:"fire",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.___fire(e,t,n)}},{key:"___open",value:function(t){this.close(),this.___openedLimitRelease();var n=[];n.push("resizable=".concat(this.___.widget.resizable?"yes":"no")),n.push("scrollbars=".concat(this.___.widget.scrollbars?"yes":"no")),n.push("dependent=".concat(this.___.widget.dependent?"yes":"no")),this.___.widget.width&&n.push("width=".concat(this.___.widget.width)),this.___.widget.height&&n.push("height=".concat(this.___.widget.height)),this.___.widget.top&&n.push("top=".concat(this.___.widget.top)),this.___.widget.left&&n.push("left=".concat(this.___.widget.left));var i=t&&t.widgetUrl?t.widgetUrl:"function"==typeof this.___.widget.url?this.___.widget.url(t):this.___.widget.url;this.___.widget.window=window.open("".concat(i),this.___.id,n.join(",")),e.___.opened.add(this),this.___.messenger.setRecipient(this.___.widget.window),this.___fire("widget.open",null,"local"),this.___startDetectionLoop()}},{key:"open",value:function(e){this.___open(e)}},{key:"___close",value:function(){this.___stopDetectionLoop(),this.___.messenger.clearRecipient(),e.___.opened.delete(this),this.___.widget.window&&!this.___.widget.window.closed&&(this.___.widget.window.close(),this.___.widget.window=null,this.___fire("widget.close",null,"local"))}},{key:"close",value:function(){this.___close()}},{key:"___openedLimitRelease",value:function(){var t,n=e.___.opened.size-this.___.widget.limit+1,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,_=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){_=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(_)throw o}}}}(Array.from(e.___.opened).reverse());try{for(i.s();!(t=i.n()).done;){var r=t.value;if(!(n>0))break;n--,r.close(),e.___.opened.delete(r)}}catch(e){i.e(e)}finally{i.f()}}},{key:"___handleMessage",value:function(e){e.eventName&&this.___fire(e.eventName,e.data,"local")}},{key:"___stopDetectionLoop",value:function(){clearInterval(this.___.closeDetectionInterval),this.___.closeDetectionInterval=null}},{key:"___startDetectionLoop",value:function(){this.___.widget.window.closed?this.___close():this.___.closeDetectionInterval||(this.___.closeDetectionInterval=setInterval(this.___startDetectionLoop.bind(this),10))}}],a=[{key:"invokeAll",value:function(t,n){"function"==typeof t?e.___.instances.forEach((function(e){t(e)})):"string"==typeof t&&e.___.instances.forEach((function(e){return"function"==typeof(null==e?void 0:e[t])?null==e?void 0:e[t].apply(e,o(n)):null}))}}],i&&_(t.prototype,i),a&&_(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}();l=d,c="___",u={opened:new Set,instances:new Set},c in l?Object.defineProperty(l,c,{value:u,enumerable:!0,configurable:!0,writable:!0}):l[c]=u,window.ClientComponent=d})();
//# sourceMappingURL=ClientComponent.js.map