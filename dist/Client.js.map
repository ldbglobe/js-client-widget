{"version":3,"file":"Client.js","mappings":"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","sources":["webpack://js-client-widget/webpack/bootstrap","webpack://js-client-widget/webpack/runtime/make namespace object","webpack://js-client-widget/./src/components/EventDispatcher.js","webpack://js-client-widget/./src/components/Messenger.js","webpack://js-client-widget/./src/components/ClientBase.js","webpack://js-client-widget/./src/Client.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export default class EventDispatcher {\r\n\tconstructor(eventSource) {\r\n\t\tthis.eventSource = eventSource;\r\n\t\tthis.events = new Set();\r\n\t}\r\n\r\n\t// registration methods\r\n\tregisterEvent(eventName, callback) {\r\n\t\tif(typeof callback === \"function\")\r\n\t\t{\r\n\t\t\tif(!this.events[eventName])\r\n\t\t\t\tthis.events[eventName] = new Set();\r\n\r\n\t\t\tthis.events[eventName].add(callback)\r\n\t\t}\r\n\t}\r\n\tunregisterEvent(eventName, callback) {\r\n\t\tif(this.events[eventName])\r\n\t\t\tthis.events[eventName].delete(callback)\r\n\t}\r\n\r\n\t// trigger event\r\n\tfireEvent(eventName, data) {\r\n\t\tif(this.events[eventName])\r\n\t\t{\r\n\t\t\tthis.events[eventName].forEach(function(callback, index) {\r\n\t\t\t\tcallback(data,{\r\n\t\t\t\t\teventSource:this.eventSource,\r\n\t\t\t\t\teventName:eventName,\r\n\t\t\t\t\tdata:data\r\n\t\t\t\t});\r\n\t\t\t}.bind(this))\r\n\t\t}\r\n\t}\r\n}","import EventDispatcher from \"./EventDispatcher.js\";\r\n\r\nexport default class Messenger {\r\n\tconstructor(param) {\r\n\t\tparam = param || {};\r\n\t\tthis.recipient = param.recipient || null;\r\n\t\tthis.id = param.id || (()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,a=>(a^Math.random()*16>>a/4).toString(16)))();\r\n\t\tthis.events = new EventDispatcher(this);\r\n\t\twindow.addEventListener('message', this.__handleMessage.bind(this))\r\n\t}\r\n\r\n\tsetRecipient(browserWindow)\r\n\t{\r\n\t\tthis.recipient = browserWindow;\r\n\t}\r\n\r\n\tgetId() {\r\n\t\treturn this.id;\r\n\t}\r\n\r\n\ton(eventName,callback) { this.events.registerEvent(eventName,callback) }\r\n\toff(eventName,callback) { this.events.unregisterEvent(eventName,callback) }\r\n\r\n\t__handleMessage(e) {\r\n\t\tlet data = typeof e.data === \"string\" ? JSON.parse(e.data) : (e.data || {});\r\n\t\tif(data.format === 'messenger' && data.id === this.id)\r\n\t\t\tthis.events.fireEvent('message',data.message);\r\n\t}\r\n\r\n\tsend(message) {\r\n\t\tif(this.recipient && typeof this.recipient.postMessage === \"function\")\r\n\t\t{\r\n\t\t\tthis.recipient.postMessage(JSON.stringify({\r\n\t\t\t\tformat:'messenger',\r\n\t\t\t\tversion:1,\r\n\t\t\t\tid:this.id,\r\n\t\t\t\tmessage:message,\r\n\t\t\t}),\"*\");\r\n\t\t}\r\n\t}\r\n}","import EventDispatcher from \"./EventDispatcher.js\";\r\nimport Messenger from \"./Messenger.js\";\r\n\r\nexport default class ClientBase {\r\n\tstatic ___ = {\r\n\t\topened:null,\r\n\t\tinstances:new Set(),\r\n\t};\r\n\tconstructor(param) {\r\n\t\tparam = param || {};\r\n\r\n\t\tthis.___ = {\r\n\t\t\tid: (()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,a=>(a^Math.random()*16>>a/4).toString(16)))(),\r\n\t\t\twidgetUrl: param.widgetUrl || null,\r\n\t\t\twidgetWindow: null,\r\n\t\t\tcloseDetectionInterval: null,\r\n\r\n\t\t};\r\n\t\tthis.___.events = new EventDispatcher(this);\r\n\t\tthis.___.messenger = new Messenger({id:this.___.id});\r\n\t\tthis.___.messenger.on('message',this.___handleMessage.bind(this));\r\n\r\n\t\tif(!this.___.widgetUrl)\r\n\t\t{\r\n\t\t\tthrow `widgetUrl parameter is mandatory`\r\n\t\t}\r\n\t\telse if(this.___.widgetUrl.match(/#/))\r\n\t\t{\r\n\t\t\tthrow `widgetUrl parameter can not contain any hash (${this.___.widgetUrl})`\r\n\t\t}\r\n\r\n\t\tClientBase.___.instances.add(this);\r\n\t}\r\n\r\n\tstatic invokeAll(methodOrCallback,args) {\r\n\t\tif(typeof methodOrCallback === \"function\")\r\n\t\t{\r\n\t\t\tClientBase.___.instances.forEach(function(client) { methodOrCallback(client) });\r\n\t\t}\r\n\t\telse if(typeof methodOrCallback === \"string\")\r\n\t\t{\r\n\t\t\tClientBase.___.instances.forEach(function(client) {\r\n\t\t\t\treturn typeof client?.[methodOrCallback] === \"function\" ? client?.[methodOrCallback](...args) : null;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t___getId() { return this.___.id; }\r\n\tgetId() { return this.___getId(); }\r\n\r\n\t/* --------------------------------------------------\r\n\t * Native available events\r\n\t * --------------------------------------------------\r\n\t * open\r\n\t * ready\r\n\t * close\r\n\t*/\r\n\t___on(eventName,callback) { this.___.events.registerEvent(eventName,callback) }\r\n\ton(eventName,callback) { this.___on(eventName,callback); }\r\n\r\n\t___off(eventName,callback) { this.___.events.unregisterEvent(eventName,callback) }\r\n\toff(eventName,callback) { this.___off(eventName,callback); }\r\n\r\n\t// all the events are handled by the messenger services\r\n\t___fire(eventName,data) { this.___.messenger.send({eventName, data}); }\r\n\tfire(eventName,callback) { this.___fire(eventName,callback); }\r\n\r\n\t___open() {\r\n\t\t// close current instance (if previously opened)\r\n\t\tthis.close();\r\n\r\n\t\t// close any other instances  previously opened\r\n\t\tif(Client.___.opened && Client.___.opened.id !== this.___.id)\r\n\t\t\tClient.___.opened.___close();\r\n\t\tClient.___.opened = this;\r\n\r\n\t\tthis.___.widgetWindow = window.open(`${this.___.widgetUrl}#id=${this.___.id}`, this.___.id, `resizable,scrollbars,width=640,height=480,top=200,left=200, dependent, modal`);\r\n\t\tthis.___.messenger.setRecipient(this.___.widgetWindow);\r\n\t\tthis.___.events.fireEvent('open');\r\n\t\tthis.___startDetectionLoop();\r\n\t}\r\n\topen() { this.___open(); }\r\n\r\n\t___close() {\r\n\t\tthis.___.messenger.setRecipient(null);\r\n\t\tthis.___stopDetectionLoop();\r\n\t\tif(this.___.widgetWindow && !this.___.widgetWindow.closed)\r\n\t\t{\r\n\t\t\tthis.___.widgetWindow.close();\r\n\t\t\tthis.___.widgetWindow = null;\r\n\t\t\tthis.___.events.fireEvent('close');\r\n\t\t}\r\n\t}\r\n\tclose() { this.___close(); }\r\n\r\n\t// **********************************************************\r\n\t// private methods\r\n\t// **********************************************************\r\n\r\n\t// generic message handling and event dispatch\r\n\t___handleMessage(message) {\r\n\t\tif(message.eventName)\r\n\t\t{\r\n\t\t\tthis.___.events.fireEvent(message.eventName, message.data);\r\n\t\t}\r\n\t}\r\n\t// passive detection of widget popup close event\r\n\t// we do not need messenging for this\r\n\t___stopDetectionLoop() {\r\n\t\tclearInterval(this.___.closeDetectionInterval);\r\n\t\tthis.___.closeDetectionInterval = null;\r\n\t}\r\n\t___startDetectionLoop() {\r\n\t\tif(this.___.widgetWindow.closed)\r\n\t\t{\r\n\t\t\tthis.___stopDetectionLoop();\r\n\t\t\tthis.___.events.fireEvent('close');\r\n\t\t}\r\n\t\telse if(!this.___.closeDetectionInterval)\r\n\t\t{\r\n\t\t\tthis.___.closeDetectionInterval = setInterval(this.___startDetectionLoop.bind(this),10);\r\n\t\t}\r\n\t}\r\n}","import ClientBase from \"./components/ClientBase.js\"\r\nwindow.ClientBase = ClientBase;"],"names":["__webpack_require__","exports","Symbol","toStringTag","Object","defineProperty","value","EventDispatcher","eventSource","this","events","Set","eventName","callback","add","data","forEach","index","bind","Messenger","param","recipient","id","replace","a","Math","random","toString","window","addEventListener","__handleMessage","browserWindow","registerEvent","unregisterEvent","e","JSON","parse","format","fireEvent","message","postMessage","stringify","version","ClientBase","___","widgetUrl","widgetWindow","closeDetectionInterval","messenger","on","___handleMessage","match","instances","methodOrCallback","args","client","___getId","___on","___off","send","___fire","close","Client","opened","___close","open","setRecipient","___startDetectionLoop","___open","___stopDetectionLoop","closed","clearInterval","setInterval"],"sourceRoot":""}